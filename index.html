<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>TikTok Live Chat</title>
  <style>
    body { font-family: sans-serif; background: #111; color: #eee; text-align: center; }
    #chat { max-width: 600px; margin: 30px auto; padding: 20px; background: #222; border-radius: 10px; }
    .msg { text-align: left; margin: 10px 0; padding: 8px; background: #333; border-radius: 5px; }
    input { padding: 10px; border-radius: 5px; border: none; width: 60%; }
    button { padding: 10px 15px; border: none; background: #0a84ff; color: white; border-radius: 5px; cursor: pointer; }
  </style>
</head>
<body>
  <h2>🟣 TikTok Live Chat Viewer</h2>
  <div>
    <input id="uniqueId" placeholder="ใส่ชื่อบัญชี TikTok (ไม่ต้องมี @)" />
    <button onclick="connect()">เชื่อมต่อ</button>
  </div>
  <div id="status">ยังไม่ได้เชื่อมต่อ</div>
  <div id="chat"></div>

  <script src="https://cdn.jsdelivr.net/npm/tiktok-live-connector/dist/tiktok-live-connector.min.js"></script>
  <script>
    let connection;

    function connect() {
      const uniqueId = document.getElementById('uniqueId').value.trim();
      if (!uniqueId) return alert("กรุณากรอกชื่อบัญชี TikTok");

      document.getElementById('status').textContent = "⏳ กำลังเชื่อมต่อ...";

      connection = new TikTokIOConnection(uniqueId);

      connection.connect().then(state => {
        document.getElementById('status').textContent = "✅ เชื่อมต่อแล้วกับ: " + state.roomId;
      }).catch(err => {
        document.getElementById('status').textContent = "❌ เชื่อมต่อไม่สำเร็จ: " + err;
      });

      connection.on('chat', data => {
        const div = document.createElement('div');
        div.className = 'msg';
        div.textContent = `${data.nickname}: ${data.comment}`;
        document.getElementById('chat').appendChild(div);
        document.getElementById('chat').scrollTop = document.getElementById('chat').scrollHeight;
      });
    }
  </script>
</body>
</html>
